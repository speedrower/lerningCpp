#include <iostream>
#include <string>

#define PI 3.14

void initMenuBox();
void menuDecision(int);
double circleArea(double);
double squareArea(double);
double rectangleArea(double, double);
double triangleArea(double, double);
void clearScreen();
bool isRight(std::string);

int main()
{
    char choice = 'T';
    int option;

    do {
        clearScreen();
        initMenuBox();
        std::cout << "Choose an option (1-4): ";

        while (!(std::cin >> option) || option < 1 || option > 4) {
            clearScreen();
            initMenuBox();
            std::cout << "You made an error. Choose an option (1-4): ";
            std::cin.clear();
            std::cin.ignore(1024, '\n');
        }

        menuDecision(option);

        do {
            std::cout << "Do you want to continue the program? (T/N)\n";
            std::cin >> choice;
            std::cin.ignore(1024, '\n');
        } while (choice != 't' && choice != 'T' && choice != 'n' && choice != 'N');

    } while (choice == 't' || choice == 'T');

    return 0;
}

void initMenuBox() {
    std::cout << "Choose an option:\n";
    std::cout << "1. Circle area\n";
    std::cout << "2. Square area\n";
    std::cout << "3. Rectangle area\n";
    std::cout << "4. Triangle area\n";
}

void menuDecision(int option) {
    clearScreen();
    double a, b;

    switch (option) {
    case 1:
        std::cout << "Enter radius: ";
        do std::cin >> a;
        while (!isRight("Wrong. Enter radius again: "));
        circleArea(a);
        break;

    case 2:
        std::cout << "Enter square side length: ";
        do std::cin >> a;
        while (!isRight("Wrong. Enter side length again: "));
        squareArea(a);
        break;

    case 3:
        std::cout << "Enter rectangle base: ";
        do std::cin >> a;
        while (!isRight("Wrong. Enter base again: "));
        std::cout << "Enter rectangle height: ";
        do std::cin >> b;
        while (!isRight("Wrong. Enter height again: "));
        rectangleArea(a, b);
        break;

    case 4:
        std::cout << "Enter triangle base: ";
        do std::cin >> a;
        while (!isRight("Wrong. Enter base again: "));
        std::cout << "Enter triangle height: ";
        do std::cin >> b;
        while (!isRight("Wrong. Enter height again: "));
        triangleArea(a, b);
        break;
    }
}

double circleArea(double r) {
    double result = PI * r * r;
    std::cout << "The area of a circle with radius " << r << " is " << result << '\n';
    return result;
}

double squareArea(double a) {
    double result = a * a;
    std::cout << "The area of a square with side " << a << " is " << result << '\n';
    return result;
}

double rectangleArea(double a, double b) {
    double result = a * b;
    std::cout << "The area of a rectangle with width " << a
              << " and height " << b << " is " << result << '\n';
    return result;
}

double triangleArea(double a, double h) {
    double result = 0.5 * a * h;
    std::cout << "The area of a triangle with base " << a
              << " and height " << h << " is " << result << '\n';
    return result;
}

void clearScreen() {
    std::cout << "\033[2J\033[H";
}

bool isRight(std::string error_msg) {
    if (!std::cin) {
        std::cin.clear();
        std::cin.ignore(1024, '\n');
        clearScreen();
        std::cout << error_msg;
        return false;
    }
    return true;
}
